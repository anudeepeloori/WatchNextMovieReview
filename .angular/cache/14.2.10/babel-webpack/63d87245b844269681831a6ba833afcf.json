{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet MoviesComponent = class MoviesComponent {\n  constructor(ds, router, hc) {\n    this.ds = ds;\n    this.router = router;\n    this.hc = hc;\n    this.p = 1; // for rating\n\n    this.starRating = 0; // Review data object\n\n    this.reviewData = {\n      userId: 1,\n      movieId: null,\n      starRating: 0,\n      reviewText: ''\n    };\n  }\n\n  ngOnInit() {\n    this.ds.getMoviesData().subscribe(items => {\n      this.movieData = items;\n    }, err => {\n      console.log(\"error fetching movies \", err);\n    });\n    this.userId = localStorage.getItem(\"userId\") || \"\";\n  } //navigate to specific movies details page\n\n\n  onSelectId(id) {\n    this.router.navigateByUrl('movies/' + id);\n  }\n\n  openReviewModal(movieId) {\n    this.reviewData.movieId = movieId;\n    this.reviewData.userId = this.userId; // Fetch existing rating (if any)\n\n    this.ds.getUserRating(this.userId, movieId).subscribe(res => {\n      if (res) {\n        this.reviewData.starRating = res.rating;\n        this.reviewData.reviewText = res.reviewText;\n      }\n    }, err => {\n      console.log(\"No existing rating found.\");\n    });\n  } // submit given review\n\n\n  submitReview() {\n    if (!this.reviewData.movieId || !this.reviewData.userId) {\n      alert(\"Error: Missing movie or user information.\");\n      return;\n    }\n\n    this.ds.submitReview(this.reviewData).subscribe(res => {\n      console.log(\"Review submitted successfully\", res);\n      alert('Review submitted successfully!');\n    }, err => {\n      console.error(\"Error saving review\", err);\n    });\n  }\n\n};\nMoviesComponent = __decorate([Component({\n  selector: 'app-movies',\n  templateUrl: './movies.component.html',\n  styleUrls: ['./movies.component.css']\n})], MoviesComponent);\nexport { MoviesComponent };","map":null,"metadata":{},"sourceType":"module"}